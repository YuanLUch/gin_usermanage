{"remainingRequest":"D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\src\\views\\sys\\user.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\src\\views\\sys\\user.vue","mtime":1712626119595},{"path":"D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1702824123341},{"path":"D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\node_modules\\babel-loader\\lib\\index.js","mtime":1702824125233},{"path":"D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1702824123341},{"path":"D:\\GraduationProject\\NPU-DatabaseMigration\\vue-new\\node_modules\\vue-loader\\lib\\index.js","mtime":1702824125775}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlckluZm86IHsKICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgcGhvbmVfbnVtYmVyOiAnJywKICAgICAgICBlbWFpbDogJycsCiAgICAgICAgcm9sZTogJycKICAgICAgfSwKICAgICAgdXNlclJ1bGVzOiB7CiAgICAgIHVzZXJuYW1lOiBbCiAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeeUqOaIt+WQjScsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgIHsKICAgICAgICAgIHZhbGlkYXRvcjogKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICAgICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXnlKjmiLflkI0nKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA8IDQgfHwgdmFsdWUubGVuZ3RoID4gMTIpIHsKICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+eUqOaIt+WQjeW6lOW9k+WcqDTliLAxMuS4quWtl+espuS5i+mXtCcpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInLAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIHBob25lX251bWJlcjogWwogICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXmiYvmnLrlj7cnLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICB7IHBhdHRlcm46IC9eMVszfDV8N3w4fDldXGR7OX0kLywgbWVzc2FnZTogJ+ivt+i+k+WFpeato+ehrueahOWPt+eggeagvOW8jycsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgIF0sCgogICAgICBlbWFpbDogW3sKICAgICAgICByZXF1aXJlZDogdHJ1ZSwvL+aYr+WQpuW/heWhqwogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXpgq7nrrHlnLDlnYAnLCAgICAgIC8v6ZSZ6K+v5o+Q56S65L+h5oGvCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInICAgICAgICAgICAgICAvL+ajgOmqjOaWueW8j++8iGJsdXLkuLrpvKDmoIfngrnlh7vlhbbku5blnLDmlrnvvIzvvIkKICAgICAgfSwKICAgICAgewogICAgICAgIHR5cGU6ICdlbWFpbCcsICAgICAgICAgICAgICAgICAgICAgICAvL+imgeajgOmqjOeahOexu+Wei++8iG51bWJlcu+8jGVtYWls77yMZGF0Zeetie+8iQogICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmraPnoa7nmoTpgq7nrrHlnLDlnYAnLAogICAgICAgIC8vIHRyaWdnZXI6IFsnYmx1cicsICdjaGFuZ2UnXe+8iGNoYW5nZeS4uuajgOmqjOeahOWtl+espuWPmOWMlueahOaXtuWAme+8iQogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9CiAgICAgIF0sCiAgICB9LAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0VXNlckluZm8oKQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0VXNlckluZm8oKSB7CiAgICAgIGNvbnN0IHRva2VuID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKQogICAgICBjb25zdCB7ZGF0YTpyZXN9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoJ3VzZXIvaW5mbycsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2VufWAgLy8g5Zyo6K+35rGC5aS05Lit5pC65bimIHRva2VuCiAgICAgICAgfQogICAgICB9KQogICAgICB0aGlzLnVzZXJJbmZvID0gcmVzLmRhdGEKICAgIH0sCiAgICBlZGl0VXNlck9rKCkgewogICAgIHRoaXMuJHJlZnMuZWRpdFVzZXJSZWYudmFsaWRhdGUoYXN5bmMgKHZhbGlkKSA9PiB7CiAgICAgIGNvbnN0IHRva2VuID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKQogICAgICBpZiAoIXZhbGlkKSByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5Y+C5pWw5LiN56ym5ZCI6KaB5rGC77yM6K+36YeN5paw6L6T5YWlJykKICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAucHV0KCd1c2VyL2VkaXQnLCB7CiAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlckluZm8udXNlcm5hbWUsCiAgICAgICAgcGFzc3dvcmQ6IHRoaXMudXNlckluZm8ucGFzc3dvcmQsCiAgICAgICAgcGhvbmVfbnVtYmVyOiB0aGlzLnVzZXJJbmZvLnBob25lX251bWJlciwKICAgICAgICBlbWFpbDogdGhpcy51c2VySW5mby5lbWFpbCwKICAgICAgICByb2xlOiB0aGlzLnVzZXJJbmZvLnJvbGUsCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCAKICAgICAgICB9CiAgICAgIH0pCiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpCiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5pu05paw55So5oi35L+h5oGv5oiQ5YqfJykKICAgICAgdGhpcy5nZXRVc2VySW5mbygpCiAgICB9KQogIH0sCiAgZWRpdFVzZXJDYW5jZWwoKSB7CiAgICB0aGlzLiRyZWZzLmVkaXRVc2VyUmVmLnJlc2V0RmllbGRzKCkKICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn57yW6L6R5bey5Y+W5raIJykKICB9LAogIH0KfQo="},{"version":3,"sources":["user.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\n<div class=\"edit-user-container\">\n  <!-- <div>\n      用户角色：\n        <span>{{ userInfo.role == '1' ? '用户' : '管理员' }}</span>\n    </div> -->\n  <el-card>\n    <el-form :model=\"userInfo\" :rules=\"userRules\" ref=\"editUserRef\" label-width=\"100px\">\n      <el-form-item label=\"用户名\" prop=\"username\">\n        <el-input v-model=\"userInfo.username\"></el-input>\n      </el-form-item>\n\n    <el-form-item label=\"电话号码\" prop=\"phone_number\">\n      <el-input v-model=\"userInfo.phone_number\"></el-input>\n    </el-form-item>\n\n    <el-form-item label=\"邮箱\" prop=\"email\">\n      <el-input v-model=\"userInfo.email\"></el-input>\n    </el-form-item>\n\n    </el-form>\n   \n    <div class=\"user-edit-buttons\">\n        <el-button type=\"primary\" @click=\"editUserOk\">确 定</el-button>\n        <el-button type=\"danger\" @click=\"editUserCancel\">取 消</el-button>\n    </div>\n  </el-card>\n</div>\n</template>\n\n<script>\n  export default {\n    data() {\n      return {\n        userInfo: {\n          username: '',\n          phone_number: '',\n          email: '',\n          role: ''\n        },\n        userRules: {\n        username: [\n          { required: true, message: '请输入用户名', trigger: 'blur' },\n          {\n            validator: (rule, value, callback) => {\n              if (!value) {\n                callback(new Error('请输入用户名'));\n              }\n              if (value.length < 4 || value.length > 12) {\n                callback(new Error('用户名应当在4到12个字符之间'));\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur',\n          },\n        ],\n        phone_number: [\n          { required: true, message: '请输入手机号', trigger: 'blur' },\n          { pattern: /^1[3|5|7|8|9]\\d{9}$/, message: '请输入正确的号码格式', trigger: 'blur' }\n        ],\n\n        email: [{\n          required: true,//是否必填\n          message: '请输入邮箱地址',      //错误提示信息\n          trigger: 'blur'              //检验方式（blur为鼠标点击其他地方，）\n        },\n        {\n          type: 'email',                       //要检验的类型（number，email，date等）\n          message: '请输入正确的邮箱地址',\n          // trigger: ['blur', 'change']（change为检验的字符变化的时候）\n          trigger: 'blur'\n        }\n        ],\n      },\n      }\n    },\n    created() {\n      this.getUserInfo()\n    },\n    methods: {\n      async getUserInfo() {\n        const token = sessionStorage.getItem('token')\n        const {data:res} = await this.$http.get('user/info', {\n          headers: {\n              'Authorization': `Bearer ${token}` // 在请求头中携带 token\n          }\n        })\n        this.userInfo = res.data\n      },\n      editUserOk() {\n       this.$refs.editUserRef.validate(async (valid) => {\n        const token = sessionStorage.getItem('token')\n        if (!valid) return this.$message.error('参数不符合要求，请重新输入')\n        const { data: res } = await this.$http.put('user/edit', {\n          username: this.userInfo.username,\n          password: this.userInfo.password,\n          phone_number: this.userInfo.phone_number,\n          email: this.userInfo.email,\n          role: this.userInfo.role,\n        }, {\n          headers: {\n                'Authorization': `Bearer ${token}` \n          }\n        })\n        if (res.status != 200) return this.$message.error(res.message)\n        this.$message.success('更新用户信息成功')\n        this.getUserInfo()\n      })\n    },\n    editUserCancel() {\n      this.$refs.editUserRef.resetFields()\n      this.$message.info('编辑已取消')\n    },\n    }\n  }\n</script>\n\n<style>\n.edit-user-container{\n  margin-top: 50px;\n}\n.user-edit-buttons {\n  text-align: center;\n  margin-top: 20px;\n}\n\n</style>"]}]}